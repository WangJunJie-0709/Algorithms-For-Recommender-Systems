# PNN模型——加强特征交叉能力

# 一、PNN模型的网络架构

![image](https://user-images.githubusercontent.com/93982957/147551985-6e0fef17-0c2a-4786-9d17-366562dd5b78.png)

相比于Deep Crossing模型，PNN模型在输入、Embedding层、多层神经网络以及最终的输出层部分并没有结构上的不同，唯一的区别在于PNN用乘积层(Product Layer)代替了Deep Crossing模型中的Stacking层。也就是说，不同特征的Embedding向量不再是简单的拼接，而是用Product操作进行两两交互，更针对性地获取特征之间的交叉信息。

另外，相比NeuralCF、PNN模型的输入不仅包括用户和物品信息，还可以有更多不同形式、不同来源的特征，通过Embedding层的编码生成同样长度的稠密Embedding向量。针对特征的交叉方式，PNN模型也给出了更多具体的交互操作方式。

# 二、Product层的多种特征交叉方式

PNN模型的乘积层由线性操作部分和乘积操作部分组成。其中，乘积特征交叉部分又分为内积操作和外积操作。无论是内积操作还是外积操作，都是对不同的特征Embedding向量进行两两组合。为保证乘积操作能够顺利进行，各Embedding向量的维度必须相同。

内积操作就是经典的向量内积运算，外积操作是对输入特征向量的各维度进行两两交叉，生成特征交叉矩阵。

事实上，PNN模型在经过对特征的线性和乘积操作后，并没有把结果直接送入上层的L1全连接层，而是在乘积层内部又进行了局部全连接层的转化。

# 三、PNN模型的特点和局限性

特点：在于强调了特征Embedding向量之间的交叉方式是多样化的，相比于简单的交由全连接层进行无差别化的处理，PNN模型定义的内积和外积操作显然更有针对性地强调了不同特征之间的交互，从而让模型更容易捕获特征的交叉信息。

局限性：对所有特征进行无差别的交叉，在一定程度上忽略了原始特征向量中包含的有价值信息。
